<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
<body>
<h1>Data size chart</h1>

<div class="chart-container" style="position: relative; height: 40vh; width: 80vw">
    <canvas id="myChart" />
</div>

<script>
    const createChart = (data, labels) => {
      let ctx = document.getElementById("myChart").getContext('2d')
      let chartOptions = {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Data size (bytes)',
            data,
            backgroundColor: [],
            borderColor: [],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true
              }
            }]
          }
        }
      }
      let myChart = new Chart(ctx, chartOptions)
    }

    const getData = () => fetch('/meta')
      .then(response => response.json())
      .then(data => {
        var sizes = $.map(data, (item, i) => item.DataSize)
        var times = $.map(data, (item, i) => new Date(item.Time).toISOString())
        console.log(data)
        createChart(sizes, times)
      })
    
    const data = getData()

</script>

</body>
</html>