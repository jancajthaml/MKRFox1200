<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<body>
<div class="chart-container" style="position: relative; height: 40vh; width: 80vw">
    <canvas id="myChart" />
</div>

<script>
    const createChart = (data, labels) => {
      let ctx = document.getElementById("myChart").getContext('2d')
      let chartOptions = {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Temperature (C)',
            data: data,
            backgroundColor: [],
            borderColor: [],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true
              }
            }]
          }
        }
      }
      let myChart = new Chart(ctx, chartOptions)
    }

    const getData = () => fetch('/meta')
      .then(response => response.json())
      .then(data => {
        console.log("Data -> ", data)

        // FIXME if dict
        //let newObj = Object.assign(...Object.entries(obj).map(([i, item]) => v.Data))

        // FIXME if Array
        let sizes = data.map(item => item.Data)
        //$.map(data, (item, i) => item.Data)
        let times = data.map(item => new Date(item.Time).toISOString())
        //$.map(data, (item, i) => new Date(item.Time).toISOString())

        createChart(sizes, times)
      })
    
    const data = getData()

</script>

</body>
</html>